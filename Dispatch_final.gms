
Sets
i Power Plant /I, II/                       
t hour /hour1 * hour168/
;

Parameters


lambda(t)     Expected electricity price at ElKrÃ¤ng hour t scenario w               /hour1 0.03668556396449345,hour2 0.03668556396449345,hour3 0.03668556396449345,hour4 0.03668556396449345,hour5 0.03668556396449345,hour6 0.0733711279289869,hour7 0.0733711279289869,hour8 0.0733711279289869,hour9 0.0733711279289869,hour10 0.0733711279289869,hour11 0.0733711279289869,hour12 0.0733711279289869,hour13 0.0733711279289869,hour14 0.0733711279289869,hour15 0.0733711279289869,hour16 0.0733711279289869,hour17 0.1467422558579738,hour18 0.1467422558579738,hour19 0.1467422558579738,hour20 0.1467422558579738,hour21 0.1467422558579738,hour22 0.1467422558579738,hour23 0.1467422558579738,hour24 0.1467422558579738,hour25 0.03668556396449345,hour26 0.03668556396449345,hour27 0.03668556396449345,hour28 0.03668556396449345,hour29 0.03668556396449345,hour30 0.0733711279289869,hour31 0.0733711279289869,hour32 0.0733711279289869,hour33 0.0733711279289869,hour34 0.0733711279289869,hour35 0.0733711279289869,hour36 0.0733711279289869,hour37 0.0733711279289869,hour38 0.0733711279289869,hour39 0.0733711279289869,hour40 0.0733711279289869,hour41 0.1467422558579738,hour42 0.1467422558579738,hour43 0.1467422558579738,hour44 0.1467422558579738,hour45 0.1467422558579738,hour46 0.1467422558579738,hour47 0.1467422558579738,hour48 0.1467422558579738,hour49 0.03668556396449345,hour50 0.03668556396449345,hour51 0.03668556396449345,hour52 0.03668556396449345,hour53 0.03668556396449345,hour54 0.0733711279289869,hour55 0.0733711279289869,hour56 0.0733711279289869,hour57 0.0733711279289869,hour58 0.0733711279289869,hour59 0.0733711279289869,hour60 0.0733711279289869,hour61 0.0733711279289869,hour62 0.0733711279289869,hour63 0.0733711279289869,hour64 0.0733711279289869,hour65 0.1467422558579738,hour66 0.1467422558579738,hour67 0.1467422558579738,hour68 0.1467422558579738,hour69 0.1467422558579738,hour70 0.1467422558579738,hour71 0.1467422558579738,hour72 0.1467422558579738,hour73 0.03668556396449345,hour74 0.03668556396449345,hour75 0.03668556396449345,hour76 0.03668556396449345,hour77 0.03668556396449345,hour78 0.0733711279289869,hour79 0.0733711279289869,hour80 0.0733711279289869,hour81 0.0733711279289869,hour82 0.0733711279289869,hour83 0.0733711279289869,hour84 0.0733711279289869,hour85 0.0733711279289869,hour86 0.0733711279289869,hour87 0.0733711279289869,hour88 0.0733711279289869,hour89 0.1467422558579738,hour90 0.1467422558579738,hour91 0.1467422558579738,hour92 0.1467422558579738,hour93 0.1467422558579738,hour94 0.1467422558579738,hour95 0.1467422558579738,hour96 0.1467422558579738,hour97 0.03668556396449345,hour98 0.03668556396449345,hour99 0.03668556396449345,hour100 0.03668556396449345,hour101 0.03668556396449345,hour102 0.0733711279289869,hour103 0.0733711279289869,hour104 0.0733711279289869,hour105 0.0733711279289869,hour106 0.0733711279289869,hour107 0.0733711279289869,hour108 0.0733711279289869,hour109 0.0733711279289869,hour110 0.0733711279289869,hour111 0.0733711279289869,hour112 0.0733711279289869,hour113 0.1467422558579738,hour114 0.1467422558579738,hour115 0.1467422558579738,hour116 0.1467422558579738,hour117 0.1467422558579738,hour118 0.1467422558579738,hour119 0.1467422558579738,hour120 0.1467422558579738,hour121 0.03668556396449345,hour122 0.03668556396449345,hour123 0.03668556396449345,hour124 0.03668556396449345,hour125 0.03668556396449345,hour126 0.0733711279289869,hour127 0.0733711279289869,hour128 0.0733711279289869,hour129 0.0733711279289869,hour130 0.0733711279289869,hour131 0.0733711279289869,hour132 0.0733711279289869,hour133 0.0733711279289869,hour134 0.0733711279289869,hour135 0.0733711279289869,hour136 0.0733711279289869,hour137 0.1467422558579738,hour138 0.1467422558579738,hour139 0.1467422558579738,hour140 0.1467422558579738,hour141 0.1467422558579738,hour142 0.1467422558579738,hour143 0.1467422558579738,hour144 0.1467422558579738,hour145 0.03668556396449345,hour146 0.03668556396449345,hour147 0.03668556396449345,hour148 0.03668556396449345,hour149 0.03668556396449345,hour150 0.0733711279289869,hour151 0.0733711279289869,hour152 0.0733711279289869,hour153 0.0733711279289869,hour154 0.0733711279289869,hour155 0.0733711279289869,hour156 0.0733711279289869,hour157 0.0733711279289869,hour158 0.0733711279289869,hour159 0.0733711279289869,hour160 0.0733711279289869,hour161 0.1467422558579738,hour162 0.1467422558579738,hour163 0.1467422558579738,hour164 0.1467422558579738,hour165 0.1467422558579738,hour166 0.1467422558579738,hour167 0.1467422558579738,hour168 0.1467422558579738/



g(i,t)      available energy by powerplant i ant time t                                /I.hour1 0.0,I.hour2 0.0,I.hour3 0.0,I.hour4 0.0,I.hour5 0.0,I.hour6 0.0,I.hour7 0.0,I.hour8 33058.1,I.hour9 138615.0,I.hour10 147012.0,I.hour11 142470.0,I.hour12 142034.0,I.hour13 143219.0,I.hour14 144268.0,I.hour15 147418.0,I.hour16 151407.0,I.hour17 139185.0,I.hour18 113019.0,I.hour19 42998.3,I.hour20 0.0,I.hour21 0.0,I.hour22 0.0,I.hour23 0.0,I.hour24 0.0,I.hour25 0.0,I.hour26 0.0,I.hour27 0.0,I.hour28 0.0,I.hour29 0.0,I.hour30 0.0,I.hour31 0.0,I.hour32 32450.0,I.hour33 142329.0,I.hour34 152468.0,I.hour35 149308.0,I.hour36 151173.0,I.hour37 152283.0,I.hour38 152679.0,I.hour39 154132.0,I.hour40 153495.0,I.hour41 141725.0,I.hour42 116311.0,I.hour43 42875.8,I.hour44 0.0,I.hour45 0.0,I.hour46 0.0,I.hour47 0.0,I.hour48 0.0,I.hour49 0.0,I.hour50 0.0,I.hour51 0.0,I.hour52 0.0,I.hour53 0.0,I.hour54 0.0,I.hour55 0.0,I.hour56 34570.0,I.hour57 143161.0,I.hour58 154980.0,I.hour59 155454.0,I.hour60 176473.0,I.hour61 176172.0,I.hour62 173355.0,I.hour63 166036.0,I.hour64 156787.0,I.hour65 144842.0,I.hour66 119861.0,I.hour67 43955.6,I.hour68 0.0,I.hour69 0.0,I.hour70 0.0,I.hour71 0.0,I.hour72 0.0,I.hour73 0.0,I.hour74 0.0,I.hour75 0.0,I.hour76 0.0,I.hour77 0.0,I.hour78 0.0,I.hour79 0.0,I.hour80 33925.1,I.hour81 144476.0,I.hour82 167160.0,I.hour83 152309.0,I.hour84 154818.0,I.hour85 155999.0,I.hour86 157125.0,I.hour87 165222.0,I.hour88 156438.0,I.hour89 144425.0,I.hour90 118279.0,I.hour91 43245.3,I.hour92 0.0,I.hour93 0.0,I.hour94 0.0,I.hour95 0.0,I.hour96 0.0,I.hour97 0.0,I.hour98 0.0,I.hour99 0.0,I.hour100 0.0,I.hour101 0.0,I.hour102 0.0,I.hour103 0.0,I.hour104 32599.9,I.hour105 144884.0,I.hour106 165882.0,I.hour107 150121.0,I.hour108 146129.0,I.hour109 145726.0,I.hour110 147505.0,I.hour111 151042.0,I.hour112 153078.0,I.hour113 141131.0,I.hour114 116236.0,I.hour115 42145.1,I.hour116 0.0,I.hour117 0.0,I.hour118 0.0,I.hour119 0.0,I.hour120 0.0,I.hour121 0.0,I.hour122 0.0,I.hour123 0.0,I.hour124 0.0,I.hour125 0.0,I.hour126 0.0,I.hour127 0.0,I.hour128 31214.7,I.hour129 128501.0,I.hour130 165150.0,I.hour131 153899.0,I.hour132 146478.0,I.hour133 141926.0,I.hour134 139908.0,I.hour135 139598.0,I.hour136 140826.0,I.hour137 137039.0,I.hour138 98732.1,I.hour139 22940.0,I.hour140 0.0,I.hour141 0.0,I.hour142 0.0,I.hour143 0.0,I.hour144 0.0,I.hour145 0.0,I.hour146 0.0,I.hour147 0.0,I.hour148 0.0,I.hour149 0.0,I.hour150 0.0,I.hour151 0.0,I.hour152 30967.8,I.hour153 138337.0,I.hour154 155205.0,I.hour155 147634.0,I.hour156 139883.0,I.hour157 135215.0,I.hour158 139274.0,I.hour159 144846.0,I.hour160 150560.0,I.hour161 138349.0,I.hour162 111152.0,I.hour163 39180.9,I.hour164 0.0,I.hour165 0.0,I.hour166 0.0,I.hour167 0.0,I.hour168 0.0,II.hour1 0.0,II.hour2 0.0,II.hour3 0.0,II.hour4 0.0,II.hour5 0.0,II.hour6 0.0,II.hour7 0.0,II.hour8 0.0,II.hour9 46194.204,II.hour10 107658.88560000001,II.hour11 124803.59640000001,II.hour12 128920.62959999999,II.hour13 130318.2678,II.hour14 133362.8688,II.hour15 129609.1692,II.hour16 123772.65600000002,II.hour17 113294.2944,II.hour18 92970.4146,II.hour19 63537.0288,II.hour20 0.0,II.hour21 0.0,II.hour22 0.0,II.hour23 0.0,II.hour24 0.0,II.hour25 0.0,II.hour26 0.0,II.hour27 0.0,II.hour28 0.0,II.hour29 0.0,II.hour30 0.0,II.hour31 0.0,II.hour32 0.0,II.hour33 43949.9088,II.hour34 107482.8258,II.hour35 120053.346,II.hour36 126435.98099999999,II.hour37 130110.435,II.hour38 135565.2984,II.hour39 129426.381,II.hour40 125886.8688,II.hour41 114887.80380000001,II.hour42 96174.25439999999,II.hour43 62681.40059999999,II.hour44 0.0,II.hour45 0.0,II.hour46 0.0,II.hour47 0.0,II.hour48 0.0,II.hour49 0.0,II.hour50 0.0,II.hour51 0.0,II.hour52 0.0,II.hour53 0.0,II.hour54 0.0,II.hour55 0.0,II.hour56 0.0,II.hour57 47059.9248,II.hour58 107309.7564,II.hour59 122199.3318,II.hour60 126024.4272,II.hour61 129741.4944,II.hour62 132809.27100000004,II.hour63 129066.0378,II.hour64 125742.2082,II.hour65 115233.9426,II.hour66 98383.41239999999,II.hour67 64422.561,II.hour68 0.0,II.hour69 0.0,II.hour70 0.0,II.hour71 0.0,II.hour72 0.0,II.hour73 0.0,II.hour74 0.0,II.hour75 0.0,II.hour76 0.0,II.hour77 0.0,II.hour78 0.0,II.hour79 0.0,II.hour80 0.0,II.hour81 45483.2364,II.hour82 105867.63600000001,II.hour83 120427.146,II.hour84 124229.06580000001,II.hour85 130387.04699999999,II.hour86 133318.7604,II.hour87 132214.18139999997,II.hour88 126442.3356,II.hour89 115597.2762,II.hour90 97065.7674,II.hour91 63601.3224,II.hour92 0.0,II.hour93 0.0,II.hour94 0.0,II.hour95 0.0,II.hour96 0.0,II.hour97 0.0,II.hour98 0.0,II.hour99 0.0,II.hour100 0.0,II.hour101 0.0,II.hour102 0.0,II.hour103 0.0,II.hour104 0.0,II.hour105 46836.392400000004,II.hour106 106118.08199999998,II.hour107 120904.4886,II.hour108 122604.531,II.hour109 128681.02379999997,II.hour110 131595.16860000003,II.hour111 127817.91959999998,II.hour112 124437.64619999999,II.hour113 113396.3418,II.hour114 96104.72759999998,II.hour115 61424.685,II.hour116 0.0,II.hour117 0.0,II.hour118 0.0,II.hour119 0.0,II.hour120 0.0,II.hour121 0.0,II.hour122 0.0,II.hour123 0.0,II.hour124 0.0,II.hour125 0.0,II.hour126 0.0,II.hour127 0.0,II.hour128 0.0,II.hour129 25875.96858,II.hour130 105096.86039999999,II.hour131 113673.7014,II.hour132 119929.6182,II.hour133 125955.64799999999,II.hour134 126412.43160000001,II.hour135 124885.08480000001,II.hour136 119061.28080000001,II.hour137 116380.76100000001,II.hour138 73635.9834,II.hour139 0.0,II.hour140 0.0,II.hour141 0.0,II.hour142 0.0,II.hour143 0.0,II.hour144 0.0,II.hour145 0.0,II.hour146 0.0,II.hour147 0.0,II.hour148 0.0,II.hour149 0.0,II.hour150 0.0,II.hour151 0.0,II.hour152 0.0,II.hour153 42596.379,II.hour154 104072.64839999999,II.hour155 119052.6834,II.hour156 123199.6206,II.hour157 126959.67480000001,II.hour158 132308.00519999999,II.hour159 128264.98439999997,II.hour160 119989.4262,II.hour161 108961.20479999999,II.hour162 88297.167,II.hour163 53373.033,II.hour164 0.0,II.hour165 0.0,II.hour166 0.0,II.hour167 0.0,II.hour168 0.0/ 


Cap(i)      powerblock capacity for powerblock i (kW)                                   /I 15000000000, II 85000/
grid_limit  maximum to grid                                                             /150000/

TES_capacity           TES capacity (UNITS!!!)                                                                 /680000/

TES_SOC_0           Starting state of charge                                            /0/
            
C1                   Startup costs  HOT                                                     /3060/
C2                  Warm start up                                                           /4930/

u_t0                initial cmmitment                                                   /0/

min_dispatch                                                                            /25500/

TES_loss                                                                                /247/
;

Positive Variables

TES_dis (t) discharg of TES in hour t

TES_charge(i,t) charging TES in hour t

TES_SOC(t)      TES state of charge in t

grid(i,t)         electrictiy to the grid at time t

spill(i,t)        lost energy in hour t

total(t)
;
$onText
binary variable
bonus(t)    Does this hour have a bonus?

$offText

binary variable

s1(t)                   Startup hot
s2(t)                   warm start up

u(t)                   unit commitment          
;

Free variable
z Revenue
;

Equation
    objfnc objective function;
    
    objfnc..   z =e= sum (t, sum(i,(lambda(t)*(grid(i,t)+TES_dis(t)) ))) - sum(t,s1(t)*C1 + s2(t)*C2 )
   
Equations

$ontext
load_balance(t)         Every energy needs to go somewhere in time t
$offtext
TES_cap(t)              TES capacity cannot be xceeded

TES_dis_cap(t)             TES limit discharge (Power block)

TES_SOC_limit(t)            can only discharge when charged



Discharge_limit(t)      maximum into grid

SOC(t)                  state of charge in t        

powerplant_limit(i,t)        limitation of systems (ex. Powerblock size)

total_eq(t)

irradiation_limit1(t)
irradiation_limit2(t)

plant1(t)
plant2(t)
$ontext
bonus1(t)
$offtext

ramp_up1(t)          0.5 hours to ramp up
ramp_up2(t)          0.5 hours to ramp up



min_dis(t)             min dispatch when CSP on

shutdown(t)             putting u back to zero when generation is 0

;



plant1(t).. g('I',t) =e= TES_charge('I',t) + grid('I',t) + spill('I',t);
plant2(t).. g('II',t) =e= TES_charge('II',t) + grid('II',t) + spill('II',t);

$ontext

powerPlant_togrid(i,t).. sum(i,grid_byPP(i,t)) =e= grid(t)

$offtext

TES_cap(t).. sum(i,TES_charge(i,t)) - TES_dis(t) + TES_SOC_0$(ord(t) = 1) + TES_SOC(t-1)$(ord(t) > 1) =l= TES_capacity ;

SOC(t).. TES_SOC(t) =e= TES_charge('I',t)*0.98*0.42 + TES_charge('II',t) - TES_dis(t) + TES_SOC(t-1)$(ord(t) > 1) + TES_SOC_0$(ord(t) = 1);

powerplant_limit(i,t).. grid(i,t)  =l= Cap(i);



TES_dis_cap(t).. grid('II',t) + TES_dis (t) =l= Cap('II')*u(t) - s1(t)*0.5*Cap('II')- s2(t)*0.5*Cap('II');

TES_SOC_limit(t).. TES_dis(t) =l= TES_SOC_0$(ord(t) = 1) + TES_SOC(t-1)$(ord(t) > 1);

Discharge_limit(t).. sum(i,grid(i,t)) + TES_dis(t) =l= grid_limit;

total_eq(t).. sum(i, grid(i,t)) + TES_dis(t) =e= total(t);

irradiation_limit1(t).. grid('I',t)=l= Cap('I');
irradiation_limit2(t).. grid('II',t) =l= Cap('II')*u(t);


ramp_up1(t).. s1(t) =g= u(t)-u(t-1)$(ord(t) > 1)-u_t0$(ord(t) = 1) - s2(t);
ramp_up2(t)$(ord(t) > 1).. s2(t) =g= u(t)-u(t-1)- u(t-2)$(ord(t) > 2)- u_t0$(ord(t) = 2)- u(t-3)- u(t-4)- u(t-5)- u(t-6);





min_dis(t).. min_dispatch*u(t) =l=   TES_dis (t) + grid('II',t);

shutdown(t).. u(t) =l= TES_dis (t) + grid('II',t);

$ontext
If ((abs((total(t)-total(t+1))/total(t) < 0.5) and ( abs(total(t)-total(t+2))/total(t) < 0.5) and (abs(total(t)-total(t+3))/total(t) < 0.5) ),
    bonus(t) =e= 1;
    
);
$offtext



model dispatch /all/;
solve dispatch using MIP maximizing z
                     
option decimals = 4
