
Sets
i Power Plant /I, II/                       
t hour /hour1 * hour168/
;

Parameters


lambda(t)     Expected electricity price at ElKrÃ¤ng hour t scenario w               /hour1 0.03668556396449345,hour2 0.03668556396449345,hour3 0.03668556396449345,hour4 0.03668556396449345,hour5 0.03668556396449345,hour6 0.0733711279289869,hour7 0.0733711279289869,hour8 0.0733711279289869,hour9 0.0733711279289869,hour10 0.0733711279289869,hour11 0.0733711279289869,hour12 0.0733711279289869,hour13 0.0733711279289869,hour14 0.0733711279289869,hour15 0.0733711279289869,hour16 0.0733711279289869,hour17 0.1467422558579738,hour18 0.1467422558579738,hour19 0.1467422558579738,hour20 0.1467422558579738,hour21 0.1467422558579738,hour22 0.1467422558579738,hour23 0.1467422558579738,hour24 0.1467422558579738,hour25 0.03668556396449345,hour26 0.03668556396449345,hour27 0.03668556396449345,hour28 0.03668556396449345,hour29 0.03668556396449345,hour30 0.0733711279289869,hour31 0.0733711279289869,hour32 0.0733711279289869,hour33 0.0733711279289869,hour34 0.0733711279289869,hour35 0.0733711279289869,hour36 0.0733711279289869,hour37 0.0733711279289869,hour38 0.0733711279289869,hour39 0.0733711279289869,hour40 0.0733711279289869,hour41 0.1467422558579738,hour42 0.1467422558579738,hour43 0.1467422558579738,hour44 0.1467422558579738,hour45 0.1467422558579738,hour46 0.1467422558579738,hour47 0.1467422558579738,hour48 0.1467422558579738,hour49 0.03668556396449345,hour50 0.03668556396449345,hour51 0.03668556396449345,hour52 0.03668556396449345,hour53 0.03668556396449345,hour54 0.0733711279289869,hour55 0.0733711279289869,hour56 0.0733711279289869,hour57 0.0733711279289869,hour58 0.0733711279289869,hour59 0.0733711279289869,hour60 0.0733711279289869,hour61 0.0733711279289869,hour62 0.0733711279289869,hour63 0.0733711279289869,hour64 0.0733711279289869,hour65 0.1467422558579738,hour66 0.1467422558579738,hour67 0.1467422558579738,hour68 0.1467422558579738,hour69 0.1467422558579738,hour70 0.1467422558579738,hour71 0.1467422558579738,hour72 0.1467422558579738,hour73 0.03668556396449345,hour74 0.03668556396449345,hour75 0.03668556396449345,hour76 0.03668556396449345,hour77 0.03668556396449345,hour78 0.0733711279289869,hour79 0.0733711279289869,hour80 0.0733711279289869,hour81 0.0733711279289869,hour82 0.0733711279289869,hour83 0.0733711279289869,hour84 0.0733711279289869,hour85 0.0733711279289869,hour86 0.0733711279289869,hour87 0.0733711279289869,hour88 0.0733711279289869,hour89 0.1467422558579738,hour90 0.1467422558579738,hour91 0.1467422558579738,hour92 0.1467422558579738,hour93 0.1467422558579738,hour94 0.1467422558579738,hour95 0.1467422558579738,hour96 0.1467422558579738,hour97 0.03668556396449345,hour98 0.03668556396449345,hour99 0.03668556396449345,hour100 0.03668556396449345,hour101 0.03668556396449345,hour102 0.0733711279289869,hour103 0.0733711279289869,hour104 0.0733711279289869,hour105 0.0733711279289869,hour106 0.0733711279289869,hour107 0.0733711279289869,hour108 0.0733711279289869,hour109 0.0733711279289869,hour110 0.0733711279289869,hour111 0.0733711279289869,hour112 0.0733711279289869,hour113 0.1467422558579738,hour114 0.1467422558579738,hour115 0.1467422558579738,hour116 0.1467422558579738,hour117 0.1467422558579738,hour118 0.1467422558579738,hour119 0.1467422558579738,hour120 0.1467422558579738,hour121 0.03668556396449345,hour122 0.03668556396449345,hour123 0.03668556396449345,hour124 0.03668556396449345,hour125 0.03668556396449345,hour126 0.0733711279289869,hour127 0.0733711279289869,hour128 0.0733711279289869,hour129 0.0733711279289869,hour130 0.0733711279289869,hour131 0.0733711279289869,hour132 0.0733711279289869,hour133 0.0733711279289869,hour134 0.0733711279289869,hour135 0.0733711279289869,hour136 0.0733711279289869,hour137 0.1467422558579738,hour138 0.1467422558579738,hour139 0.1467422558579738,hour140 0.1467422558579738,hour141 0.1467422558579738,hour142 0.1467422558579738,hour143 0.1467422558579738,hour144 0.1467422558579738,hour145 0.03668556396449345,hour146 0.03668556396449345,hour147 0.03668556396449345,hour148 0.03668556396449345,hour149 0.03668556396449345,hour150 0.0733711279289869,hour151 0.0733711279289869,hour152 0.0733711279289869,hour153 0.0733711279289869,hour154 0.0733711279289869,hour155 0.0733711279289869,hour156 0.0733711279289869,hour157 0.0733711279289869,hour158 0.0733711279289869,hour159 0.0733711279289869,hour160 0.0733711279289869,hour161 0.1467422558579738,hour162 0.1467422558579738,hour163 0.1467422558579738,hour164 0.1467422558579738,hour165 0.1467422558579738,hour166 0.1467422558579738,hour167 0.1467422558579738,hour168 0.1467422558579738/



g(i,t)      available energy by powerplant i ant time t                                 /I.hour1 0.0,I.hour2 0.0,I.hour3 0.0,I.hour4 0.0,I.hour5 0.0,I.hour6 0.0,I.hour7 0.0,I.hour8 68456.8,I.hour9 137266.0,I.hour10 146619.0,I.hour11 164818.0,I.hour12 174420.0,I.hour13 170052.0,I.hour14 164576.0,I.hour15 154957.0,I.hour16 144637.0,I.hour17 126456.0,I.hour18 106389.0,I.hour19 43449.7,I.hour20 6294.54,I.hour21 0.0,I.hour22 0.0,I.hour23 0.0,I.hour24 0.0,I.hour25 0.0,I.hour26 0.0,I.hour27 0.0,I.hour28 0.0,I.hour29 0.0,I.hour30 0.0,I.hour31 0.0,I.hour32 70381.9,I.hour33 145281.0,I.hour34 152748.0,I.hour35 153833.0,I.hour36 156237.0,I.hour37 167620.0,I.hour38 163170.0,I.hour39 154403.0,I.hour40 143661.0,I.hour41 128450.0,I.hour42 107029.0,I.hour43 44336.7,I.hour44 6349.3,I.hour45 0.0,I.hour46 0.0,I.hour47 0.0,I.hour48 0.0,I.hour49 0.0,I.hour50 0.0,I.hour51 0.0,I.hour52 0.0,I.hour53 0.0,I.hour54 0.0,I.hour55 0.0,I.hour56 74930.0,I.hour57 148751.0,I.hour58 166781.0,I.hour59 134509.0,I.hour60 166283.0,I.hour61 149384.0,I.hour62 119994.0,I.hour63 154090.0,I.hour64 85892.9,I.hour65 135757.0,I.hour66 106535.0,I.hour67 44171.7,I.hour68 6612.79,I.hour69 0.0,I.hour70 0.0,I.hour71 0.0,I.hour72 0.0,I.hour73 0.0,I.hour74 0.0,I.hour75 0.0,I.hour76 0.0,I.hour77 0.0,I.hour78 0.0,I.hour79 0.0,I.hour80 68200.6,I.hour81 145835.0,I.hour82 166033.0,I.hour83 171004.0,I.hour84 169535.0,I.hour85 133247.0,I.hour86 149900.0,I.hour87 142024.0,I.hour88 143106.0,I.hour89 126333.0,I.hour90 103893.0,I.hour91 43701.6,I.hour92 6572.42,I.hour93 0.0,I.hour94 0.0,I.hour95 0.0,I.hour96 0.0,I.hour97 0.0,I.hour98 0.0,I.hour99 0.0,I.hour100 0.0,I.hour101 0.0,I.hour102 0.0,I.hour103 0.0,I.hour104 69335.0,I.hour105 145584.0,I.hour106 155099.0,I.hour107 150486.0,I.hour108 150450.0,I.hour109 150557.0,I.hour110 152931.0,I.hour111 151654.0,I.hour112 141370.0,I.hour113 124989.0,I.hour114 105001.0,I.hour115 43528.3,I.hour116 6496.02,I.hour117 0.0,I.hour118 0.0,I.hour119 0.0,I.hour120 0.0,I.hour121 0.0,I.hour122 0.0,I.hour123 0.0,I.hour124 0.0,I.hour125 0.0,I.hour126 0.0,I.hour127 0.0,I.hour128 70434.1,I.hour129 148465.0,I.hour130 167518.0,I.hour131 171413.0,I.hour132 171144.0,I.hour133 166583.0,I.hour134 162792.0,I.hour135 153959.0,I.hour136 143312.0,I.hour137 127890.0,I.hour138 106621.0,I.hour139 43665.0,I.hour140 6535.04,I.hour141 0.0,I.hour142 0.0,I.hour143 0.0,I.hour144 0.0,I.hour145 0.0,I.hour146 0.0,I.hour147 0.0,I.hour148 0.0,I.hour149 0.0,I.hour150 0.0,I.hour151 0.0,I.hour152 70586.4,I.hour153 147853.0,I.hour154 164489.0,I.hour155 172827.0,I.hour156 172116.0,I.hour157 170753.0,I.hour158 165131.0,I.hour159 157352.0,I.hour160 144928.0,I.hour161 131110.0,I.hour162 106646.0,I.hour163 44175.7,I.hour164 6896.93,I.hour165 0.0,I.hour166 0.0,I.hour167 0.0,I.hour168 0.0,II.hour1 0.0,II.hour2 0.0,II.hour3 0.0,II.hour4 0.0,II.hour5 0.0,II.hour6 0.0,II.hour7 0.0,II.hour8 8919.6156,II.hour9 72082.09680000001,II.hour10 73249.848,II.hour11 98375.9364,II.hour12 126461.77320000001,II.hour13 127817.91959999998,II.hour14 130826.26200000002,II.hour15 129544.50179999998,II.hour16 121128.39480000001,II.hour17 101231.76839999999,II.hour18 91747.341,II.hour19 64801.968,II.hour20 0.0,II.hour21 0.0,II.hour22 0.0,II.hour23 0.0,II.hour24 0.0,II.hour25 0.0,II.hour26 0.0,II.hour27 0.0,II.hour28 0.0,II.hour29 0.0,II.hour30 0.0,II.hour31 0.0,II.hour32 16076.353019999999,II.hour33 89032.80539999998,II.hour34 107023.42560000002,II.hour35 121454.34840000002,II.hour36 128946.4218,II.hour37 127827.63840000001,II.hour38 130821.40259999997,II.hour39 129521.70000000001,II.hour40 118977.1758,II.hour41 105314.41200000001,II.hour42 91985.4516,II.hour43 68919.7488,II.hour44 0.0,II.hour45 0.0,II.hour46 0.0,II.hour47 0.0,II.hour48 0.0,II.hour49 0.0,II.hour50 0.0,II.hour51 0.0,II.hour52 0.0,II.hour53 0.0,II.hour54 0.0,II.hour55 0.0,II.hour56 0.0,II.hour57 78392.5884,II.hour58 104954.8164,II.hour59 54820.012800000004,II.hour60 108443.118,II.hour61 79701.2622,II.hour62 41053.7064,II.hour63 122229.98339999998,II.hour64 0.0,II.hour65 87069.6078,II.hour66 88628.3538,II.hour67 63740.376000000004,II.hour68 0.0,II.hour69 0.0,II.hour70 0.0,II.hour71 0.0,II.hour72 0.0,II.hour73 0.0,II.hour74 0.0,II.hour75 0.0,II.hour76 0.0,II.hour77 0.0,II.hour78 0.0,II.hour79 0.0,II.hour80 6800.61816,II.hour81 82386.26759999999,II.hour82 104840.0598,II.hour83 116860.34639999998,II.hour84 121696.94459999999,II.hour85 54044.3778,II.hour86 95304.4218,II.hour87 94518.32040000001,II.hour88 116812.12620000001,II.hour89 99280.90619999998,II.hour90 85286.5818,II.hour91 62768.122200000005,II.hour92 0.0,II.hour93 0.0,II.hour94 0.0,II.hour95 0.0,II.hour96 0.0,II.hour97 0.0,II.hour98 0.0,II.hour99 0.0,II.hour100 0.0,II.hour101 0.0,II.hour102 0.0,II.hour103 0.0,II.hour104 12772.97028,II.hour105 86965.3176,II.hour106 106681.77240000002,II.hour107 119021.658,II.hour108 126479.71560000001,II.hour109 127716.99360000002,II.hour110 128217.8856,II.hour111 129475.72260000001,II.hour112 118913.6298,II.hour113 101321.8542,II.hour114 90363.5334,II.hour115 65064.37560000001,II.hour116 0.0,II.hour117 0.0,II.hour118 0.0,II.hour119 0.0,II.hour120 0.0,II.hour121 0.0,II.hour122 0.0,II.hour123 0.0,II.hour124 0.0,II.hour125 0.0,II.hour126 0.0,II.hour127 0.0,II.hour128 14701.96518,II.hour129 88389.8694,II.hour130 108726.83220000002,II.hour131 119091.18479999999,II.hour132 126371.6874,II.hour133 125188.6104,II.hour134 130668.51839999999,II.hour135 129468.9942,II.hour136 119097.5394,II.hour137 103369.90440000001,II.hour138 90345.591,II.hour139 64122.7734,II.hour140 0.0,II.hour141 0.0,II.hour142 0.0,II.hour143 0.0,II.hour144 0.0,II.hour145 0.0,II.hour146 0.0,II.hour147 0.0,II.hour148 0.0,II.hour149 0.0,II.hour150 0.0,II.hour151 0.0,II.hour152 12712.003499999999,II.hour153 86150.43360000002,II.hour154 103716.41699999997,II.hour155 117928.6668,II.hour156 122832.54900000001,II.hour157 128874.65219999998,II.hour158 129367.3206,II.hour159 128248.91100000002,II.hour160 117940.62839999999,II.hour161 108637.12020000002,II.hour162 90042.06539999999,II.hour163 65520.0378,II.hour164 0.0,II.hour165 0.0,II.hour166 0.0,II.hour167 0.0,II.hour168 0.0/

Cap(i)      powerblock capacity for powerblock i (kW)                                   /I 15000000000, II 85000/
grid_limit  maximum to grid                                                             /150000/

TES_capacity           TES capacity (UNITS!!!)                                                                 /680000/

TES_SOC_0           Starting state of charge                                            /0/
            
C1                   Startup costs  HOT                                                     /3060/
C2                  Warm start up                                                           /4930/

u_t0                initial cmmitment                                                   /0/

min_dispatch                                                                            /25500/

TES_loss                                                                                /247/
;

Positive Variables

TES_dis (t) discharg of TES in hour t

TES_charge(i,t) charging TES in hour t

TES_SOC(t)      TES state of charge in t

grid(t)         electrictiy to the grid at time t

spill(i,t)        lost energy in hour t

total(t)
;
$onText
binary variable
bonus(t)    Does this hour have a bonus?

$offText

binary variable

s1(t)                   Startup hot
s2(t)                   warm start up

u(t)                   unit commitment          
;

Free variable
z Revenue
;

Equation
    objfnc objective function;
    
    objfnc..   z =e= sum (t, sum(i,(lambda(t)*(grid(t)+TES_dis(t)) ))) - sum(t,s1(t)*C1 + s2(t)*C2 )
   
Equations

$ontext
load_balance(t)         Every energy needs to go somewhere in time t
$offtext
TES_cap(t)              TES capacity cannot be xceeded

TES_dis_cap(t)             TES limit discharge (Power block)

TES_SOC_limit(t)            can only discharge when charged



Discharge_limit(t)      maximum into grid

SOC(t)                  state of charge in t        

powerplant_limit(t)        limitation of systems (ex. Powerblock size)

total_eq(t)


plant1(t)
plant2(t)
$ontext
bonus1(t)
$offtext

ramp_up1(t)          0.5 hours to ramp up
ramp_up2(t)          0.5 hours to ramp up



min_dis(t)             min dispatch when CSP on

shutdown(t)             putting u back to zero when generation is 0

;



plant1(t).. g('I',t) =e= TES_charge('I',t) + grid(t) + spill('I',t);
plant2(t).. g('II',t) =e= TES_charge('II',t) + spill('II',t);

$ontext

powerPlant_togrid(i,t).. sum(i,grid_byPP(i,t)) =e= grid(t)

$offtext

TES_cap(t).. sum(i,TES_charge(i,t)) - TES_dis(t) + TES_SOC_0$(ord(t) = 1) + TES_SOC(t-1)$(ord(t) > 1) =l= TES_capacity ;

SOC(t).. TES_SOC(t) =e= TES_charge('I',t)*0.99*0.42 + TES_charge('II',t) - TES_dis(t) + TES_SOC(t-1)$(ord(t) > 1) + TES_SOC_0$(ord(t) = 1);

powerplant_limit(t).. grid(t)  =l= Cap('I');



TES_dis_cap(t).. TES_dis (t) =l= Cap('II')*u(t) - s1(t)*0.5*Cap('II')- s2(t)*0.5*Cap('II');

TES_SOC_limit(t).. TES_dis(t) =l= TES_SOC_0$(ord(t) = 1) + TES_SOC(t-1)$(ord(t) > 1) + TES_charge('I',t)*0.99*0.42 + TES_charge('II',t);

Discharge_limit(t).. grid(t) + TES_dis(t) =l= grid_limit;

total_eq(t).. grid(t) + TES_dis(t) =e= total(t);




ramp_up1(t).. s1(t) =g= u(t)-u(t-1)$(ord(t) > 1)-u_t0$(ord(t) = 1) - s2(t);
ramp_up2(t)$(ord(t) > 1).. s2(t) =g= u(t)-u(t-1)- u(t-2)$(ord(t) > 2)- u_t0$(ord(t) = 2)- u(t-3)- u(t-4)- u(t-5)- u(t-6);





min_dis(t).. min_dispatch*u(t) =l=   TES_dis (t);

shutdown(t).. u(t) =l= TES_dis (t);

$ontext
If ((abs((total(t)-total(t+1))/total(t) < 0.5) and ( abs(total(t)-total(t+2))/total(t) < 0.5) and (abs(total(t)-total(t+3))/total(t) < 0.5) ),
    bonus(t) =e= 1;
    
);
$offtext



model dispatch /all/;
solve dispatch using MIP maximizing z
                     
option decimals = 4
